var express = require('express');
var bodyParser = require('body-parser');
var _ = require('underscore');
var db = require('./db.js');

var app = express();
var PORT = process.env.PORT || 3000;
var http = require('http').Server(app);
var oaks = [];
app.use(express.static(__dirname + '/public'));
app.use(bodyParser.json());

app.get('/', function(req, res){
	res.send('OAk API Root');
});

app.post('/players', function(req, res){
	var body = _.pick(req.body, 'name');
	db.player.create(body).then(function(player){
		res.json(player);
	}, function(e){
		res.status(400).json(e);
	});
});
//app.get('/oaks', function(req, res){
//	db.sod.findAll({attributes:{}}).then(function(sod){
//		res.json(sod.toJSON());
//	});
//});

// GET /oaks/:id
//app.get('/oaks/:id', function(req, res){
//	var oakId = parseInt(req.params.id, 10);
//	db.sod.findById(oakId).then(function(sod){
//		if(!!sod){
//			res.json(sod.toJSON());
//		}else{
//			res.status(404).send();
//		}
//	},function(e){
//			res.status(500).send();
//	});
//});


//db.sequelize.sync().then(function(){
////	app.listen(PORT, function(){
////		console.log('Express listening on port', + PORT + '!');
////	});
//	http.listen(PORT, function(){
//		console.log('Server started');
//	});
//});

http.listen(PORT, function(){
		console.log('Server started');
	});
